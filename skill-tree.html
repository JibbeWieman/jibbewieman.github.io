<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Portfolio website of Jibbe Wieman">
    <title>Jibbe Wieman | Leveling & Skill Tree System</title>
    <link rel="icon" type="image/svg+xml" href="assets/images/icons/personal-icon-light.svg">
    <link rel="canonical" href="https://jibbewieman.github.io/skill-tree.html" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/navigation.css">
    <link rel="stylesheet" href="css/project-page.css">
    <link rel="stylesheet" href="css/style.css">

    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/highlight.min.js" defer></script>

    <script type="module" src="/js/scripts/injectHTML.js"></script>
    <script src="/js/scripts/expandable-section.js" defer></script>
    <script src="/js/scripts/mode-toggle.js" defer></script>
    <script src="/js/scripts/csharp-wrapper.js" defer></script>
</head>
<body>

    <div id="nav-placeholder"></div>

    <div class="arrow-button arrow-left" onclick="window.location.href='the-news.html';">
        <img src="assets/images/icons/arrow-left.png" alt="Left Arrow">
    </div>
    <div class="arrow-button arrow-right" onclick="window.location.href='noorderpoort.html';">
        <img src="assets/images/icons/arrow-right.png" alt="Right Arrow">
    </div>

    <!-- Image Overlay -->
    <div id="image-overlay">
        <div class="overlay-content">
            <span class="close-button" onclick="closeOverlay()">&times;</span>
            <img id="overlay-image" src="" alt="Enlarged Image">
        </div>
    </div>

    <header class="skill-tree-header">
        <h1 style="z-index: 3;">Levelling & Skill Tree System</h1>
        <!--<img src="assets/images/skill-tree/banner.g" alt="Project Parasite Logo" />-->
    </header>

    <div class="main-wrapper">
        <main>
            <aside class="project-sidebar">
                <dl class="project-details">
                    <dt>PROJECT STATUS:</dt>
                    <dd>FINISHED</dd>
                    <dt>PROJECT TYPE:</dt>
                    <dd>UNIVERSITY</dd>
                    <dt>PROJECT DURATION:</dt>
                    <dd>9 SEPTEMBER 2024 - 15 NOVEMBER 2024</dd>
                    <dt>SOFTWARE USED:</dt>
                    <dd>UNITY</dd>
                    <dt>LANGUAGES USED:</dt>
                    <dd>C#</dd>
                    <dt>PRIMARY ROLE(S):</dt>
                    <dd>PROGRAMMER</dd>
                    <dt>TEAM SIZE:</dt>
                    <dd>1</dd>
                </dl>
            </aside>

            <div class="content-wrapper">
                <div class="text-wrapper">
                    <p>For my university's programming track I focused on programming a levelling system and skill tree, and incorporate that into the existing data base of the Unity Learn FPS game.</p>
                    <p>During this project I learned about software and game design patterns (e.g. Observer, Command), and incorporated some into the system. Besides this I also made a UML Chart for the two systems:</p>
                </div>

                <br />

                <div class="social-buttons">
                    <a href="https://github.com/JibbeWieman/LevellingSkillTree" target="_blank" aria-label="GitHub">
                        <img src="assets/images/icons/github.png" alt="GitHub Icon" title="GitHub">
                    </a>
                </div>

                <br />

                <div class="contributions">
                    <h2>My Contributions</h2>
                    <div class="expandable-container">
                        <button class="expandable-button" onclick="toggleContent(this)">
                            UML Charts
                            <img class="expand-icon" src="assets/images/icons/arrow-down.png" alt="Expand">
                        </button>
                        <div class="expandable-content">
                            <img src="assets/images/skill-tree/uml-legend.png" onclick="openOverlay(this)" alt="UML Legend">
                            <img src="assets/images/skill-tree/uml-leveling.png" onclick="openOverlay(this)" alt="UML Legend">
                            <img src="assets/images/skill-tree/uml-skill-tree.jpg" onclick="openOverlay(this)" alt="UML Legend">
                        </div> <!-- expandable-content -->
                    </div> <!-- expandable-container -->

                    <div class="expandable-container">
                        <button class="expandable-button" onclick="toggleContent(this)">
                            Levelling System
                            <img class="expand-icon" src="assets/images/icons/arrow-down.png" alt="Expand">
                        </button>
                        <div class="expandable-content">
                            <p>In the following scripts I used the Observer from the project to prevent requiring Update methods, and streamlining other methods preventing the need of direct associations.</p>
                            <p>As for certain variables types I chose to keep them public, to stay consistent with the rest of the FPS Micro game scripts, which for some reason chose to keep almost all their variables public.</p>
                            <!-- XP‑Manager snippet -->
                            <button class="expandable-button"
                                    onclick="toggleContent(this,'skill-tree/xp-manager.cs')">
                                Script Snippet – XP Manager
                                <img src="assets/images/icons/arrow-down.png" class="expand-icon" alt="">
                            </button>
                            <div class="expandable-content"></div>

                            <!--<button class="expandable-button" onclick="toggleContent(this)">
                                    Script Snippet - XP Manager
                                    <img class="expand-icon" src="assets/images/icons/arrow-down.png" alt="Expand">
                                </button>
                                <div class="expandable-content">
                                    <div class="code-container">
                                        <pre><code class="language-csharp">
    <span class="keyword">using</span> Unity.FPS.Game;
    <span class="keyword">using</span> UnityEngine;

    <span class="keyword">public</span> <span class="keyword">class</span> <span class="class-name">XpManager</span> : <span class="class-name">Manager</span>
    {
                                        <span class="preprocessor">#region</span> VARIABLES

                                        <span class="keyword">public</span> <span class="type">int</span> PlayerLevel { <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; }
                                        <span class="keyword">public</span> <span class="type">int</span> PlayerXP { <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; }

        [<span class="attribute">Tooltip</span>(<span class="string">"Previous XP Threshold required to level up"</span>)]
                                        <span class="keyword">public</span> <span class="type">int</span> PrevThreshold { <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; }

        [<span class="attribute">Tooltip</span>(<span class="string">"XP required to level up"</span>)]
                                        <span class="keyword">public</span> <span class="type">int</span> CurThreshold { <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; }

                                        <span class="preprocessor">#endregion</span>

                                        <span class="preprocessor">#region</span> UNITY METHODS

                                        <span class="keyword">public override</span> <span class="keyword">void</span> <span class="method">Start</span>()
        {
                                        <span class="comment">// Initialise XP system and subscribe to XP update events</span>
                                        <span class="keyword">base</span>.Start();

                                        <span class="class-name">EventManager</span>.AddListener&lt;<span class="class-name">XpUpdateEvent</span>&gt;(<span class="method">UpdateXP</span>);

            PlayerLevel = <span class="number">1</span>;
            PlayerXP = <span class="number">0</span>;
            PrevThreshold = <span class="number">0</span>;

                                        <span class="method">CalculateXPThreshold</span>();
        }

                                        <span class="keyword">private</span> <span class="keyword">void</span> <span class="method">OnDestroy</span>()
        {
                                        <span class="comment">// Unsubscribe from XP update events</span>
                                        <span class="class-name">EventManager</span>.RemoveListener&lt;<span class="class-name">XpUpdateEvent</span>&gt;(<span class="method">UpdateXP</span>);
        }

                                        <span class="preprocessor">#endregion</span>

                                        <span class="preprocessor">#region</span> XP METHODS

                                        <span class="comment">// Updates the player's XP based on the event data</span>
                                        <span class="keyword">public void</span> <span class="method">UpdateXP</span>(<span class="class-name">XpUpdateEvent</span> <span class="parameter">evt</span>)
        {
            PlayerXP = evt.XP;

                                        <span class="keyword">if</span> (PlayerXP &gt;= CurThreshold)
            {
                                        <span class="class-name">LevelUpEvent</span> lvlUpEvt = <span class="class-name">Events</span>.LevelUpEvent;
                                        <span class="method">LevelUp</span>(lvlUpEvt);
            }
        }

                                        <span class="comment">// Handles logic for when the player levels up</span>
                                        <span class="keyword">private void</span> <span class="method">LevelUp</span>(<span class="class-name">LevelUpEvent</span> <span class="parameter">evt</span>)
        {
            evt.Level++;

            PlayerLevel = evt.Level;

                                        <span class="class-name">SkillPointsChangedEvent</span> skillPointEvent = <span class="class-name">Events</span>.SkillPointsChangedEvent;
            skillPointEvent.SkillPoints++;

                                        <span class="method">CalculateXPThreshold</span>();
        }

                                        <span class="comment">// Calculates the next XP threshold for levelling up</span>
                                        <span class="keyword">private void</span> <span class="method">CalculateXPThreshold</span>()
        {
            PrevThreshold = CurThreshold;
            CurThreshold = PlayerLevel * <span class="number">150</span>;
        }

                                        <span class="preprocessor">#endregion</span>
    }
    </code></pre>
                                    </div>-->
                            <!-- code-container -->
                            <!--</div>--> <!-- code expandable-content -->
                            <!-- PlayerXpBar snippet -->
                            <button class="expandable-button"
                                    onclick="toggleContent(this,'skill-tree/playerxpbar.cs')">
                                Script Snippet – PlayerXpBar
                                <img src="assets/images/icons/arrow-down.png" class="expand-icon" alt="">
                            </button>
                            <div class="expandable-content"></div>
                            <!--<div class="code-container">
                                        <pre><code class="language-csharp">
    <span class="keyword">using</span> System.Collections;
    <span class="keyword">using</span> TMPro;
    <span class="keyword">using</span> Unity.FPS.Game;
    <span class="keyword">using</span> UnityEngine;
    <span class="keyword">using</span> UnityEngine.UI;

    <span class="keyword">namespace</span> Unity.FPS.UI
    {
                                        <span class="keyword">public class</span> <span class="class-name">PlayerXpBar</span> : <span class="class-name">MonoBehaviour</span>
        {
                                        <span class="preprocessor">#region</span> VARIABLES

            [<span class="attribute">Tooltip</span>(<span class="string">"Image component displaying current XP"</span>)]
                                        <span class="keyword">public</span> Image XpFillImage;

                                        <span class="keyword">public</span> TextMeshProUGUI PlayerLevelText;

            [<span class="attribute">SerializeField</span>, <span class="attribute">Tooltip</span>(<span class="string">"Speed of the XP bar transition"</span>)]
                                        <span class="keyword">private</span> <span class="type">float</span> LerpSpeed = <span class="number">5f</span>;

            [<span class="attribute">SerializeField</span>]
                                        <span class="keyword">private</span> SceneTypeObject ST_GameManager;

                                        <span class="keyword">private</span> XpManager _xpManager;
                                        <span class="keyword">private</span> Coroutine currentLerpCoroutine;

                                        <span class="preprocessor">#endregion</span>

                                        <span class="preprocessor">#region</span> UNITY METHODS

                                        <span class="comment">// Initialises XP Manager and sets up XP bar on start</span>
                                        <span class="keyword">void</span> <span class="method">Start</span>()
            {
                _xpManager = ST_GameManager.Objects[<span class="number">0</span>].GetComponent&lt;<span class="class-name">XpManager</span>&gt;();

                                        <span class="class-name">DebugUtility</span>.HandleErrorIfNullGetComponent&lt;<span class="class-name">XpManager</span>, <span class="class-name">PlayerXpBar</span>&gt;(_xpManager, <span class="keyword">this</span>, gameObject);

                                        <span class="class-name">EventManager</span>.AddListener&lt;<span class="class-name">XpUpdateEvent</span>&gt;(<span class="method">UpdateXpBar</span>);

                XpFillImage.fillAmount = <span class="number">0</span>;
            }

                                        <span class="comment">// Cleans up event subscriptions when destroyed</span>
                                        <span class="keyword">private</span> <span class="keyword">void</span> <span class="method">OnDestroy</span>()
            {
                                        <span class="class-name">EventManager</span>.RemoveListener&lt;<span class="class-name">XpUpdateEvent</span>&gt;(<span class="method">UpdateXpBar</span>);
            }

                                        <span class="preprocessor">#endregion</span>

                                        <span class="preprocessor">#region</span> XP METHODS

                                        <span class="comment">// Updates the XP bar fill amount and level text</span>
                                        <span class="keyword">private</span> <span class="keyword">void</span> <span class="method">UpdateXpBar</span>(<span class="class-name">XpUpdateEvent</span> evt)
            {
                                        <span class="type">float</span> targetXpFill = (<span class="type">float</span>)(_xpManager.PlayerXP - _xpManager.PrevThreshold)
                / (<span class="type">float</span>)(_xpManager.CurThreshold - _xpManager.PrevThreshold);

                                        <span class="keyword">if</span> (currentLerpCoroutine != <span class="keyword">null</span>)
                {
                    StopCoroutine(currentLerpCoroutine);
                }

                currentLerpCoroutine = StartCoroutine(<span class="method">LerpXpFill</span>(targetXpFill));
                PlayerLevelText.text = _xpManager.PlayerLevel.ToString();
            }

                                        <span class="comment">// Lerps the fill amount of the XP bar towards the target value</span>
                                        <span class="keyword">private</span> IEnumerator <span class="method">LerpXpFill</span>(<span class="type">float</span> targetXpFill)
            {
                                        <span class="keyword">while</span> (Mathf.Abs(XpFillImage.fillAmount - targetXpFill) > <span class="number">0.01f</span>)
                {
                    XpFillImage.fillAmount = Mathf.Lerp(XpFillImage.fillAmount, targetXpFill, Time.deltaTime * LerpSpeed);
                                        <span class="keyword">yield return</span> <span class="keyword">null</span>;
                }

                XpFillImage.fillAmount = targetXpFill;
            }

                                        <span class="preprocessor">#endregion</span>
        }
    }
                                        </code></pre>
                                    </div>-->
                            <!-- code-container -->
                            <!--</div>--> <!-- code expandable-content -->

                            <button class="expandable-button"
                                    onclick="toggleContent(this,'skill-tree/events.cs')">
                                Script Snippet – Observer
                                <img src="assets/images/icons/arrow-down.png" class="expand-icon" alt="">
                            </button>
                            <div class="expandable-content"></div>
                            <!--<div class="code-container">
                                    <pre><code class="language-csharp">
                                    <span class="keyword"> using</span> <span class="namespace"> UnityEngine</span>;

    <span class="keyword">namespace</span> <span class="namespace"> Unity.FPS.Game</span>
    {
                                    <span class="comment">// The Game Events used across the Game.</span>
                                    <span class="comment">// Anytime there is a need for a new event, it should be added here.</span>

                                    <span class="keyword">public static</span> <span class="class-name">class</span> <span class="class-name">Events</span>
        {
                                    <span class="preprocessor">#region</span> BASE EVENTS

                                    <span class="keyword">public static</span> <span class="type">ObjectiveUpdateEvent</span> <span class="variable">ObjectiveUpdateEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">AllObjectivesCompletedEvent</span> <span class="variable">AllObjectivesCompletedEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">GameOverEvent</span> <span class="variable">GameOverEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">PlayerDeathEvent</span> <span class="variable">PlayerDeathEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">EnemyKillEvent</span> <span class="variable">EnemyKillEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">PickupEvent</span> <span class="variable">PickupEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">AmmoPickupEvent</span> <span class="variable">AmmoPickupEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">DamageEvent</span> <span class="variable">DamageEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">DisplayMessageEvent</span> <span class="variable">DisplayMessageEvent</span> = <span class="keyword">new</span>();

                                    <span class="preprocessor">#endregion</span>

                                    <span class="preprocessor">#region Custom Events (Jibbe)</span>

                                    <span class="keyword">public static</span> <span class="type">XpUpdateEvent</span> <span class="variable">XpUpdateEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">LevelUpEvent</span> <span class="variable">LevelUpEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">SkillPointsChangedEvent</span> <span class="variable">SkillPointsChangedEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">SkillUnlockedEvent</span> <span class="variable">SkillUnlockedEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">PlayerEvent</span> <span class="variable">PlayerEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">BlasterDMGIncreasedEvent</span> <span class="variable">BlasterDMGIncreasedEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">HPIncreasedEvent</span> <span class="variable">HPIncreasedEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">SpeedIncreasedEvent</span> <span class="variable">SpeedIncreasedEvent</span> = <span class="keyword">new</span>();
                                    <span class="keyword">public static</span> <span class="type">SkillTreeUIClosedEvent</span> <span class="variable">SkillTreeUIClosedEvent</span> = <span class="keyword">new</span>();

                                    <span class="preprocessor">#endregion</span>
        }

                                    <span class="preprocessor">#region</span> EVENT CLASSES

                                    <span class="comment"> /// &lt;summary&gt;</span>
                                    <span class="comment"> /// Event carrying a reference to the Player GameObject.</span>
                                    <span class="comment"> /// &lt;/summary&gt;</span>
                                    <span class="keyword"> public class</span> <span class="class-name"> PlayerEvent</span> : <span class="type"> GameEvent</span>
        {
                                    <span class="keyword">public</span> <span class="type">GameObject</span> <span class="variable">player</span>;
        }

                                    <span class="comment"> /// &lt;summary&gt;</span>
                                    <span class="comment"> /// Event triggered when the blaster damage buff is increased.</span>
                                    <span class="comment"> /// &lt;/summary&gt;</span>
                                    <span class="keyword"> public class</span> <span class="class-name"> BlasterDMGIncreasedEvent</span> : <span class="type"> GameEvent</span>
        {
                                    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">dmgBuff</span>;
                                    <span class="comment"> /// &lt;/summary&gt;</span>
                                    <span class="comment"> /// Damage buff amount. Automatically broadcasts event when set.</span>
                                    <span class="comment"> /// &lt;/summary&gt;</span>
                                    <span class="keyword">public</span> <span class="type">int</span> <span class="property">DMGBuff</span>
            {
                                    <span class="keyword">get</span> => <span class="variable">dmgBuff</span>;
                                    <span class="keyword">set</span>
                {
                                    <span class="variable">dmgBuff</span> = <span class="variable">value</span>;
                                    <span class="type">EventManager</span>.<span class="method">Broadcast</span>(<span class="type">Events</span>.<span class="property">BlasterDMGIncreasedEvent</span>);
                }
            }
        }

                                    <span class="comment"> /// &lt;summary&gt;</span>
                                    <span class="comment"> /// Event triggered when the player's HP is increased.</span>
                                    <span class="comment"> /// &lt;/summary&gt;</span>
                                    <span class="keyword"> public class</span> <span class="class-name"> HPIncreasedEvent</span> : <span class="type"> GameEvent</span>
        {
                                    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">hpBuff</span>;
                                    <span class="comment"> /// &lt;/summary&gt;</span>
                                    <span class="comment"> /// HP buff amount. Automatically broadcasts event when set.</span>
                                    <span class="comment"> /// &lt;/summary&gt;</span>
                                    <span class="keyword">public</span> <span class="type">int</span> <span class="property">HPBuff</span>
            {
                                    <span class="keyword">get</span> => <span class="variable">hpBuff</span>;
                                    <span class="keyword">set</span>
                {
                                    <span class="variable">hpBuff</span> = <span class="variable">value</span>;
                                    <span class="type">EventManager</span>.<span class="method">Broadcast</span>(<span class="type">Events</span>.<span class="property">HPIncreasedEvent</span>);
                }
            }
        }

                                    <span class="comment"> /// &lt;summary&gt;</span>
                                    <span class="comment"> /// Event triggered when the player's speed is increased.</span>
                                    <span class="comment"> /// &lt;/summary&gt;</span>
                                    <span class="keyword"> public class</span> <span class="class-name"> SpeedIncreasedEvent</span> : <span class="type"> GameEvent</span>
        {
                                    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">speedBuff</span>;
                                    <span class="comment"> /// &lt;/summary&gt;</span>
                                    <span class="comment"> /// HP buff amount. Automatically broadcasts event when set.</span>
                                    <span class="comment"> /// &lt;/summary&gt;</span>
                                    <span class="keyword">public</span> <span class="type">int</span> <span class="property">SpeedBuff</span>
            {
                                    <span class="keyword">get</span> => <span class="variable">speedBuff</span>;
                                    <span class="keyword">set</span>
                {
                                    <span class="variable">speedBuff</span> = <span class="variable">value</span>;
                                    <span class="type">EventManager</span>.<span class="method">Broadcast</span>(<span class="type">Events</span>.<span class="property">SpeedIncreasedEvent</span>);
                }
            }
        }
    ...</code></pre>
                                </div>-->
                            <!-- code-container -->
                            <!--</div>--> <!-- code expandable-content -->
                            <!--</div>--> <!-- expandable-content -->
                        </div> <!-- expandable-container -->

                    <div class="expandable-container">
                        <button class="expandable-button" onclick="toggleContent(this)">
                            Skill Tree
                            <img class="expand-icon" src="assets/images/icons/arrow-down.png" alt="Expand">
                        </button>
                        <div class="expandable-content">
                            <p>Will be added in the near future.</p>
                            <button class="expandable-button" onclick="toggleContent(this)">
                                Script Snippet
                                <img class="expand-icon" src="assets/images/icons/arrow-down.png" alt="Expand">
                            </button>
                            <div class="expandable-content">
                                <div class="code-container">
                                    <pre><code class="language-csharp">

                                    </code></pre>
                                </div> <!-- code-container -->
                            </div> <!-- code expandable-content -->
                        </div> <!-- expandable-content -->
                    </div> <!-- expandable-container -->

                </div> <!-- contributions -->
            </div><!-- content-wrapper -->
        </main>
    </div> <!-- main-wrapper -->

    <div id="footer-placeholder"></div>

</body>
</html>